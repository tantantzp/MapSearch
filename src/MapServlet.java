import data.*;import data.KdTree.Entry;import java.io.IOException;import java.util.*;import net.sf.json.JSONObject;import javax.servlet.*;import javax.servlet.http.HttpServlet;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;public class MapServlet extends HttpServlet {	private static final long serialVersionUID = 1L;	private String dataPath = "E:\\database\\MapApp\\WebContent\\zipcode-address.json";	private DataHandler dataHandler = null;	public MapServlet() {		super();		initiate();	}	public void initiate(){		System.out.println("start read data");		dataHandler = new DataHandler(dataPath);		System.out.println("read data finish");	}	protected void doPost(HttpServletRequest request,HttpServletResponse response) 			       throws ServletException, IOException {		System.out.println("POST");		String command = request.getParameter("command");		if(!command.equals("Query")) return;				String latstr = request.getParameter("lat");		String lngstr = request.getParameter("lng");		String query = request.getParameter("query");						//set center		double[] centerLoc = new double[2];		centerLoc[0] = Double.parseDouble(latstr);		centerLoc[1] = Double.parseDouble(lngstr);		dataHandler.setCenter(centerLoc);		        //System.out.println(latstr+","+lngstr);				System.out.println("query: " + query);		//search results		List<Entry<JSONObject>> queryResults = dataHandler.searchQuery(query);		String resStr = "";		if (queryResults == null || queryResults.size() < 1) {			resStr += "no results";		} else {			for (Entry<JSONObject> entry : queryResults) {			    resStr += entry.value.toString();			    resStr += "!";			}			resStr = resStr.substring(0, resStr.length()-1);		    resStr += "***";		    resStr += dataHandler.createHTMLTable(queryResults);		    			//System.out.println(resStr);		}        response.getWriter().write(resStr);		}		protected void doGet(HttpServletRequest request,HttpServletResponse response) 			       throws ServletException, IOException {		doPost(request,response);	}}